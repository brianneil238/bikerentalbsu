(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[606],{1553:function(e,s,a){Promise.resolve().then(a.bind(a,280))},280:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return o}});var t=a(3827),d=a(4090),i=a(1126),n=a(7907),l=a(4232),r=a(4469);let c=(0,l.default)(()=>a.e(569).then(a.bind(a,2569)),{loadableGenerated:{webpack:()=>[2569]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"h-[400px] bg-gray-100 animate-pulse rounded-lg"})});function o(){let{data:e}=(0,i.useSession)(),s=(0,n.useRouter)(),[a,l]=(0,d.useState)(null),[o,x]=(0,d.useState)(!0),[m,h]=(0,d.useState)(null);(0,d.useEffect)(()=>{u();let e=setInterval(u,1e4);return()=>clearInterval(e)},[]);let u=async()=>{try{let e=await fetch("/api/rentals");if(!e.ok)throw Error("Failed to fetch rental");let a=(await e.json()).find(e=>"ACTIVE"===e.status);if(!a){s.push("/rent");return}l(a)}catch(e){h("Failed to load rental information")}finally{x(!1)}},b=async()=>{if(a)try{if(!(await fetch("/api/rentals",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({rentalId:a.id,action:"end"})})).ok)throw Error("Failed to end rental");s.push("/dashboard")}catch(e){h("Failed to end rental. Please try again.")}};return o?(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,t.jsx)("div",{className:"h-[400px] bg-gray-200 rounded"}),(0,t.jsx)("div",{className:"h-24 bg-gray-200 rounded"})]})}):a?(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Active Rental"}),m&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg mb-6",children:m}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Rental Details"}),(0,t.jsxs)("dl",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-gray-600",children:"Bike Number"}),(0,t.jsxs)("dd",{className:"font-medium",children:["#",a.bike.bikeNumber]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-gray-600",children:"Model"}),(0,t.jsx)("dd",{className:"font-medium",children:a.bike.model})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-gray-600",children:"Start Time"}),(0,t.jsx)("dd",{className:"font-medium",children:(0,r.Q)(new Date(a.startTime),{addSuffix:!0})})]}),a.distance&&(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-gray-600",children:"Distance"}),(0,t.jsxs)("dd",{className:"font-medium",children:[a.distance.toFixed(2)," km"]})]}),a.carbonSaved&&(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-gray-600",children:"Carbon Saved"}),(0,t.jsxs)("dd",{className:"font-medium",children:[a.carbonSaved.toFixed(2)," kg COâ‚‚"]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Live Location"}),(0,t.jsx)("div",{className:"h-[300px] rounded-lg overflow-hidden",children:a.bike.currentLocation&&(0,t.jsx)(c,{bikes:[a.bike],selectedBike:a.bike,onBikeSelect:()=>{}})})]})]}),(0,t.jsx)("div",{className:"mt-8 flex justify-end",children:(0,t.jsx)("button",{onClick:b,className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"End Rental"})})]})]})}):null}}},function(e){e.O(0,[126,263,971,69,744],function(){return e(e.s=1553)}),_N_E=e.O()}]);